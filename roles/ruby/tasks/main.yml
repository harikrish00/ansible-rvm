---
- include: install_packages.yml

- name: checking that RVM is installed
  stat: 
    path: "{{ rvm_init_script }}"
  ignore_errors: True
  sudo: true
  register: rvm_install_result

- include: install_rvm.yml
  when: rvm_install_result.stat.exists == False
  become: yes
  become_user: "{{ rvm_user }}"

- include: update_rvm.yml
  when: rvm_auto_update_rvm and rvm_install_result.stat.exists == true
  become: yes
  become_user: "{{ rvm_user }}"

- include: install_ruby.yml
  become: yes
  become_user: "{{ rvm_user }}"

- include: select_ruby.yml
  become: yes
  become_user: "{{ rvm_user }}"
